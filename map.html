<!-- Load the Polymer.Element base class -->
<link rel="import" href="bower_components/polymer/polymer-element.html">

<dom-module id="scratch-map">
  <template>

    <!-- Styles MUST be inside template -->
    <style>

      :host, #map {
        width: 100%;
        height: 100%;
        padding: 0;
        margin: 0;
      }

    </style>

    <div id="map"></div>

  </template>

  <script>

    // Extend Polymer.Element base class
    class ScratchMap extends Polymer.Element {

      static get is() { return 'scratch-map' }

      static get config() {
        // properties, observers meta data
        return {
          map : null,
        };
      }

      connectedCallback() {
        super.connectedCallback();

        const mapEl = this.$.map;
        this.map = L.map(mapEl).setView([0.0, 0.0], 3);
        this.addOSMBasemapLayer();
        this.addCountriesLayer("countries.geojson");
      } 

      addOSMBasemapLayer() {
       L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
          maxZoom: 18,
          noWrap: true,
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(this.map)
      }

      addCountriesLayer(geojsonUrl) {
        fetch(geojsonUrl).then((geojson) => {
          geojson.json().then((countries) => {
             const countriesStyle = { 
               stroke: true,
               color: "rgba(0,0,0,0.3)",
               weight: 4, 
               fill: true,
               fillColor: "rgba(0,0,0,0.3)",
             }
             L.geoJson(countries, countriesStyle).addTo(this.map);
          });
        });
      }

    }

    // Register custom element definition using standard platform API
    customElements.define(ScratchMap.is, ScratchMap);

  </script>
</dom-module>
